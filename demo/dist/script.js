function v(f,$){return{method:f,args:$}}function d(f){return Object.fromEntries(f.split(/\s*,\s*/).map(($)=>{let[A,K]=$.split(/\s*=\s*/),_=K.replace(/^'|'$/g,"");if(!isNaN(_))_=Number(_);return[A,_]}))}var s={"=":null,"<":"$lt",">":"$gt","<=":"$lte",">=":"$gte","!=":"$not",IN:"$in","NOT IN":"$nin"};function o(f,$){for(let A in $)if(A.startsWith("$"))f[A]=$[A];else if(f[A]!==void 0)if(typeof f[A]==="object"&&!Array.isArray(f[A]))Object.assign(f[A],$[A]);else f[A]=$[A];else f[A]=$[A]}function h(f){if(!f)return{};let $=f.trim();if($===""||$==="1")return{};let A=f.replace(/\s+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/g," ").match(/(?:\(|\)|'[^']*'|"[^"]*"|[^\s()'"]+)/g)||[],K=[],_={},G=[],g=[];for(let m=0;m<A.length;m++){let q=A[m].trim();if(!q)continue;if(q==="(")K.push({current:_,operatorStack:G,stack:g}),_={},G=[],g=[];else if(q===")"){let j=_;if(g.length>0)g.push(_),j={$or:g};if(K.length===0)throw Error("Unmatched closing parenthesis");let w=K.pop(),Y=w.current,P=w.operatorStack,n=w.stack;if(P.length>0){let X=P.pop();if(X==="OR")n.push(Y),_=j;else if(X==="AND"){let i={};o(i,Y),o(i,j),_=i}}else{let X={};o(X,Y),o(X,j),_=X}G=w.operatorStack,g=w.stack}else if(q.toUpperCase()==="AND"||q.toUpperCase()==="OR")G.push(q.toUpperCase());else{if(G.length){if(G[G.length-1]==="OR")g.push(_),_={},G.pop()}let j=q,w=A[++m]?.trim(),Y=A[++m]?.trim();if(!j||!w||Y===void 0)throw Error(`Invalid condition near '${j} ${w} ${Y}'`);if(Y.startsWith("'")&&Y.endsWith("'")||Y.startsWith('"')&&Y.endsWith('"'))Y=Y.slice(1,-1);if(!isNaN(Number(Y)))Y=Number(Y);if(w.toUpperCase()==="IN"||w.toUpperCase()==="NOT IN"){if(!Y.startsWith("(")||!Y.endsWith(")"))throw Error(`Invalid syntax for '${w}' near '${Y}'`);Y=Y.slice(1,-1).split(",").map((n)=>{if(n=n.trim(),n.startsWith("'")&&n.endsWith("'")||n.startsWith('"')&&n.endsWith('"'))return n.slice(1,-1);return isNaN(Number(n))?n:Number(n)})}let P=s[w.toUpperCase()];if(P!==void 0)if(P===null)_[j]=Y;else{if(!_[P])_[P]={};_[P][j]=Y}else _[j]=Y}}if(g.length>0)return g.push(_),{$or:g};return _}function C(f){let $=f.match(/SELECT\s+(.+?)\s+FROM\s+([\w\/]+)(?:\s+WHERE\s+(.+))?/i);if(!$)throw Error("Invalid SELECT syntax");let A=$[1].trim(),K=$[2],_=$[3]?h($[3]):{},G=B(A);return v("find",[K,_,{},G])}function B(f){if(f=f.trim(),f==="*")return{};let $=f.match(/\*\s+EXCLUDE\s+(.+)/i);if($)return{exclude:$[1].split(/\s*,\s*/)};return{select:f.split(/\s*,\s*/)}}function z(f){let $=f.match(/INSERT INTO ([\w\/]+)\s*\(([^)]+)\)\s*VALUES\s*\(([^)]+)\)/i);if(!$)throw Error("Invalid INSERT syntax");let A=$[1],K=$[2].split(/\s*,\s*/);function _(q){let j=[],w="",Y=!1,P=!1;for(let n=0;n<q.length;n++){let X=q[n];if(X==="'"&&!P)Y=!Y,w+=X;else if(X==='"'&&!Y)P=!P,w+=X;else if(X===","&&!Y&&!P)j.push(w),w="";else w+=X}return j.push(w),j}let g=_($[3]).map((q)=>{if(q=q.trim(),q.length>=2){if(q[0]==="'"&&q[q.length-1]==="'")q=q.substring(1,q.length-1);else if(q[0]==='"'&&q[q.length-1]==='"')q=q.substring(1,q.length-1)}return q});if(K.length!==g.length)throw Error("Number of columns and values does not match");let m=Object.fromEntries(K.map((q,j)=>[q,isNaN(g[j])?g[j]:Number(g[j])]));return v("add",[A,m])}function u(f){let $=f.match(/UPDATE\s+([\w\/]+)\s+SET\s+(.+)\s+WHERE\s+(.+)/i);if(!$)throw Error("Invalid UPDATE syntax");let A=$[1],K=d($[2]),_=h($[3]);return v("update",[A,_,K])}function c(f){let $=f.match(/DELETE FROM ([\w\/]+)(?: WHERE (.+))?/i);if(!$)throw Error("Invalid DELETE syntax");let A=$[1],K=$[2]?h($[2]):{};return v("remove",[A,K])}function T(f){if(!/^GET\s+COLLECTIONS$/i.test(f))throw Error("Invalid GET COLLECTIONS syntax.");return v("getCollections",[])}function k(f){let $=f.match(/^CREATE\s+(?:TABLE|COLLECTION)\s+(IF\s+NOT\s+EXISTS\s+)?(\w+).*/i);if(!$)throw Error("Invalid CREATE TABLE/COLLECTION syntax.");return v("ensureCollection",[$[2]])}function l(f){let $=f.match(/^DROP\s+(?:TABLE|COLLECTION)\s+(?:IF\s+EXISTS\s+)?(\w+)$/i);if(!$)throw Error("Invalid DROP TABLE/COLLECTION syntax.");return v("removeCollection",[$[1]])}function r(f){let $=f.match(/^EXISTS\s+(?:TABLE|COLLECTION)\s+(\w+)$/i);if(!$)throw Error("Invalid EXISTS TABLE/COLLECTION syntax.");return v("issetCollection",[$[1]])}class J{parse(f){f=f.replace(/\s+/g," ").trim();let $=f.split(/\s+/),A=$[0].toUpperCase();if(A==="SELECT")return C(f);else if(A==="INSERT")return z(f);else if(A==="UPDATE")return u(f);else if(A==="DELETE")return c(f);else if(A==="GET")return T(f);else if(A==="CREATE")return k(f);else if(A==="DROP")return l(f);else if(A==="EXISTS")return r(f);else throw Error("Unknown query: "+$[0])}}var a=J;var F=new a;function U(f,$){let{args:A,method:K}=f,_=A[0],G={db:$,d:{}},g={find:{options:A[2],searchOpts:A[3]},findOne:{searchOpts:A[2]},update:{updater:A[2]},updateOne:{updater:A[2]},add:{data:A[1]}};if(G.d={[K]:g[K]||{}},G.d[K].collection=_,K!=="add")G.d[K].search=A[1];return G}function t(f,$=""){let A=[];for(let K in f)if(f.hasOwnProperty(K)){let _=f[K],G=$?`${$}.${K}`:K;if(typeof _==="object"&&_!==null&&!Array.isArray(_))A.push(...t(_,G).split(" ").filter((g)=>g.length>0));else if(Array.isArray(_))A.push(`${G}=${JSON.stringify(_)}`);else A.push(`${G}=${_}`)}return A.join(" ")}function W(f){let $="";if(!("d"in f))throw Error("Not implemented yet");let A=f.d,K=Object.keys(A)[0],_=A[K],G=_.collection,g=K.replace("One","");if(g==="find");else if(g==="update")G="~"+G;else if(g==="remove")G="-"+G;else if(g==="add")G="+"+G;else if(K==="updateOneOrAdd")G="updateOneOrAdd "+G;if(K.endsWith("One"))G+="!";if(delete _.collection,Z(_,"search","s"),Z(_,"data","d"),Z(_,"options","o"),Z(_,"updater","u"),_.searchOpts?.select)_.select=_.searchOpts.select.reduce((q,j)=>{return q[j]=1,q},{}),delete _.searchOpts.select;Z(_,"select","e");let m=t(_);return $+=`${f.db} ${G} ${m}`,$}function Z(f,$,A){if(!($ in f))return;f[A]=f[$],delete f[$]}function V(f,$,A=!1){let K=F.parse(f),_=U(K,$);return A?W(_):_}var S=document.querySelector("#sql-input"),N=document.querySelector("#db-name"),E=document.querySelector("#translate-btn"),H=document.querySelector("#vql-object"),p=document.querySelector("#vql-string"),e=document.querySelector("#copy-vql"),R=document.querySelector("#copy-string"),O=document.querySelector("#output-card"),b="",I="",M=document.querySelectorAll(".tab-link"),Q=document.querySelectorAll(".tab-pane");M.forEach((f)=>{f.addEventListener("click",()=>{M.forEach((A)=>A.classList.remove("active")),Q.forEach((A)=>A.classList.remove("active")),f.classList.add("active");let $=document.querySelector(`#${f.dataset.tab}`);if($)$.classList.add("active")})});function x(){let f=S.value.trim(),$=N.value.trim()||"db1";if(!f){H.textContent="Please enter a SQL query.",p.textContent="",O.classList.add("hidden");return}try{let A=V(f,$,!1);b=JSON.stringify(A,null,2),H.textContent=b,I=W(A),p.textContent=I,O.classList.remove("hidden")}catch(A){console.error("Translation error:",A);let K=A instanceof Error?A.message:"An unknown error occurred.";b=`Error: ${K}`,I=`Error: ${K}`,H.textContent=b,p.textContent=I,O.classList.remove("hidden")}}E.addEventListener("click",x);function D(f){if(f.key==="Enter"&&!f.shiftKey)f.preventDefault(),E.click()}S.addEventListener("keydown",D);N.addEventListener("keydown",D);var y;function L(f){let $=f.closest(".result-box");if(!$)return;let A=$.querySelector(".copy-tooltip");if(!A)return;clearTimeout(y),A.classList.add("visible"),y=setTimeout(()=>{A.classList.remove("visible")},1500)}e.addEventListener("click",()=>{if(!b)return;navigator.clipboard.writeText(b),L(e)});R.addEventListener("click",()=>{if(!I)return;navigator.clipboard.writeText(I),L(R)});x();

//# debugId=1F27F61620BDC59364756E2164756E21
//# sourceMappingURL=script.js.map
