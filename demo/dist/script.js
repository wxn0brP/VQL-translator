function b(_,$){return{method:_,args:$}}function H(_){return Object.fromEntries(_.split(/\s*,\s*/).map(($)=>{let[A,K]=$.split(/\s*=\s*/),f=K.replace(/^'|'$/g,"");if(!isNaN(f))f=Number(f);return[A,f]}))}var y={"=":null,"<":"$lt",">":"$gt","<=":"$lte",">=":"$gte","!=":"$not",IN:"$in","NOT IN":"$nin"};function v(_,$){for(let A in $)if(A.startsWith("$"))_[A]=$[A];else if(_[A]!==void 0)if(typeof _[A]==="object"&&!Array.isArray(_[A]))Object.assign(_[A],$[A]);else _[A]=$[A];else _[A]=$[A]}function Z(_){if(!_)return{};let $=_.trim();if($===""||$==="1")return{};let A=_.replace(/\s+(?=(?:[^'"]*['"][^'"]*['"])*[^'"]*$)/g," ").match(/(?:\(|\)|'[^']*'|"[^"]*"|[^\s()'"]+)/g)||[],K=[],f={},G=[],j=[];for(let I=0;I<A.length;I++){let q=A[I].trim();if(!q)continue;if(q==="(")K.push({current:f,operatorStack:G,stack:j}),f={},G=[],j=[];else if(q===")"){let w=f;if(j.length>0)j.push(f),w={$or:j};if(K.length===0)throw Error("Unmatched closing parenthesis");let g=K.pop(),Y=g.current,X=g.operatorStack,P=g.stack;if(X.length>0){let m=X.pop();if(m==="OR")P.push(Y),f=w;else if(m==="AND"){let W={};v(W,Y),v(W,w),f=W}}else{let m={};v(m,Y),v(m,w),f=m}G=g.operatorStack,j=g.stack}else if(q.toUpperCase()==="AND"||q.toUpperCase()==="OR")G.push(q.toUpperCase());else{if(G.length){if(G[G.length-1]==="OR")j.push(f),f={},G.pop()}let w=q,g=A[++I]?.trim(),Y=A[++I]?.trim();if(!w||!g||Y===void 0)throw Error(`Invalid condition near '${w} ${g} ${Y}'`);if(Y.startsWith("'")&&Y.endsWith("'")||Y.startsWith('"')&&Y.endsWith('"'))Y=Y.slice(1,-1);if(!isNaN(Number(Y)))Y=Number(Y);if(g.toUpperCase()==="IN"||g.toUpperCase()==="NOT IN"){if(!Y.startsWith("(")||!Y.endsWith(")"))throw Error(`Invalid syntax for '${g}' near '${Y}'`);Y=Y.slice(1,-1).split(",").map((P)=>{if(P=P.trim(),P.startsWith("'")&&P.endsWith("'")||P.startsWith('"')&&P.endsWith('"'))return P.slice(1,-1);return isNaN(Number(P))?P:Number(P)})}let X=y[g.toUpperCase()];if(X!==void 0)if(X===null)f[w]=Y;else{if(!f[X])f[X]={};f[X][w]=Y}else f[w]=Y}}if(j.length>0)return j.push(f),{$or:j};return f}function p(_){let $=_.match(/SELECT\s+(.+?)\s+FROM\s+([\w\/]+)(?:\s+WHERE\s+(.+))?/i);if(!$)throw Error("Invalid SELECT syntax");let A=$[1].trim(),K=$[2],f=$[3]?Z($[3]):{},G=S(A);return b("find",[K,f,{},G])}function S(_){if(_=_.trim(),_==="*")return{};let $=_.match(/\*\s+EXCLUDE\s+(.+)/i);if($)return{exclude:$[1].split(/\s*,\s*/)};return{select:_.split(/\s*,\s*/)}}function O(_){let $=_.match(/INSERT INTO ([\w\/]+)\s*\(([^)]+)\)\s*VALUES\s*\(([^)]+)\)/i);if(!$)throw Error("Invalid INSERT syntax");let A=$[1],K=$[2].split(/\s*,\s*/);function f(q){let w=[],g="",Y=!1,X=!1;for(let P=0;P<q.length;P++){let m=q[P];if(m==="'"&&!X)Y=!Y,g+=m;else if(m==='"'&&!Y)X=!X,g+=m;else if(m===","&&!Y&&!X)w.push(g),g="";else g+=m}return w.push(g),w}let j=f($[3]).map((q)=>{if(q=q.trim(),q.length>=2){if(q[0]==="'"&&q[q.length-1]==="'")q=q.substring(1,q.length-1);else if(q[0]==='"'&&q[q.length-1]==='"')q=q.substring(1,q.length-1)}return q});if(K.length!==j.length)throw Error("Number of columns and values does not match");let I=Object.fromEntries(K.map((q,w)=>[q,isNaN(j[w])?j[w]:Number(j[w])]));return b("add",[A,I])}function C(_){let $=_.match(/UPDATE\s+([\w\/]+)\s+SET\s+(.+)\s+WHERE\s+(.+)/i);if(!$)throw Error("Invalid UPDATE syntax");let A=$[1],K=H($[2]),f=Z($[3]);return b("update",[A,f,K])}function o(_){let $=_.match(/DELETE FROM ([\w\/]+)(?: WHERE (.+))?/i);if(!$)throw Error("Invalid DELETE syntax");let A=$[1],K=$[2]?Z($[2]):{};return b("remove",[A,K])}function z(_){if(!/^GET\s+COLLECTIONS$/i.test(_))throw Error("Invalid GET COLLECTIONS syntax.");return b("getCollections",[])}function i(_){let $=_.match(/^CREATE\s+(?:TABLE|COLLECTION)\s+(IF\s+NOT\s+EXISTS\s+)?(\w+).*/i);if(!$)throw Error("Invalid CREATE TABLE/COLLECTION syntax.");return b("ensureCollection",[$[2]])}function d(_){let $=_.match(/^DROP\s+(?:TABLE|COLLECTION)\s+(?:IF\s+EXISTS\s+)?(\w+)$/i);if(!$)throw Error("Invalid DROP TABLE/COLLECTION syntax.");return b("removeCollection",[$[1]])}function k(_){let $=_.match(/^EXISTS\s+(?:TABLE|COLLECTION)\s+(\w+)$/i);if(!$)throw Error("Invalid EXISTS TABLE/COLLECTION syntax.");return b("issetCollection",[$[1]])}class u{parse(_){_=_.replace(/\s+/g," ").trim();let $=_.split(/\s+/),A=$[0].toUpperCase();if(A==="SELECT")return p(_);else if(A==="INSERT")return O(_);else if(A==="UPDATE")return C(_);else if(A==="DELETE")return o(_);else if(A==="GET")return z(_);else if(A==="CREATE")return i(_);else if(A==="DROP")return d(_);else if(A==="EXISTS")return k(_);else throw Error("Unknown query: "+$[0])}}var T=u;var N=new T;function E(_,$){let{args:A,method:K}=_,f=A[0],G={db:$,d:{}},j={find:{options:A[2],searchOpts:A[3]},findOne:{searchOpts:A[2]},update:{updater:A[2]},updateOne:{updater:A[2]},add:{data:A[1]}};if(G.d={[K]:j[K]||{}},G.d[K].collection=f,K!=="add")G.d[K].search=A[1];return G}function c(_,$=""){let A=[];for(let K in _)if(_.hasOwnProperty(K)){let f=_[K],G=$?`${$}.${K}`:K;if(typeof f==="object"&&f!==null&&!Array.isArray(f))A.push(...c(f,G).split(" ").filter((j)=>j.length>0));else A.push(`${G}=${f}`)}return A.join(" ")}function h(_){let $="";if(!("d"in _))throw Error("Not implemented yet");let A=_.d,K=Object.keys(A)[0],f=A[K],G=f.collection,j=K.replace("One","");if(j==="find");else if(j==="update")G="~"+G;else if(j==="remove")G="-"+G;else if(j==="add")G="+"+G;else if(K==="updateOneOrAdd")G="updateOneOrAdd "+G;if(K.endsWith("One"))G+="!";delete f.collection,n(f,"search","s"),n(f,"data","d"),n(f,"options","o"),n(f,"updater","u");let I=c(f);return $+=`${j} ${G} ${I}`,$}function n(_,$,A){if(!($ in _))return;_[A]=_[$],delete _[$]}function J(_,$,A=!1){let K=N.parse(_),f=E(K,$);return A?h(f):f}var a=document.querySelector("#sql-input"),V=document.querySelector("#db-name"),R=document.querySelector("#translate-btn"),l=document.querySelector("#vql-object"),r=document.querySelector("#vql-string"),t="",M="";R.addEventListener("click",()=>{let _=a.value.trim(),$=V.value.trim()||"db1";if(!_){alert("Please enter a SQL query");return}try{let A=J(_,$,!1);l.textContent=t=JSON.stringify(A,null,2);let K=h(A);r.textContent=M=K}catch(A){console.error("Translation error:",A),l.textContent=`Error: ${A.message}`,r.textContent=`Error: ${A.message}`}});function e(_){if(_.key==="Enter")R.click()}a.addEventListener("keydown",e);V.addEventListener("keydown",e);document.querySelector("#copy-vql").addEventListener("click",()=>{navigator.clipboard.writeText(t),alert("VQL object copied to clipboard")});document.querySelector("#copy-string").addEventListener("click",()=>{navigator.clipboard.writeText(M),alert("VQL string copied to clipboard")});

//# debugId=17AE61D19C22DB9064756E2164756E21
//# sourceMappingURL=script.js.map
